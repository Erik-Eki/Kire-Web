---
import Navigation from './Navigation.astro'
import Hamburger from './Hamburger.astro'
import LoginModal from '$components/login-svelte/LoginModal.svelte'
//import Login from '$components/login/login.astro'

// supabase.auth.onAuthStateChange((event, session) => {
// 	//   if (event == 'SIGNED_IN') console.log('SIGNED_IN', session)
// 	//   if (event == 'SIGNED_OUT') console.log('SIGNED_OUT', session)
// 	//   if (event == 'TOKEN_REFRESHED') console.log('TOKEN_REFRESHED', session)

// 	console.log("AUTH CHANGE:", event, session)
// 	// if (session) {
// 	// 	user = session.user
// 	// 	if (session && session.user) {
// 	// 		console.log(session.user)
// 	// 	}
// 	// }

// })

// const isLoggedIn = !(user == null);
//const session = Astro.cookies.get('session_token')?.value;

// session={
//         (event) => {Astro.cookies.set('session_token', event.detail.sessionCookie)}
//     }
---

<script>
	function processResults(event) {

	console.log(event)

	// searchResult.forEach(i => {
    //   const resultDiv = document.createElement('div');
    //   resultDiv.innerHTML = `<h2>${i.slug}</h2><p>${i.title}</p><p>${i.description}</p>`;
    //   resultsDiv.appendChild(resultDiv);
    // });
}
</script>

<p class="mb-2 mt-2 border border-t-white"></p>
<div class="kire-web">KIRE WEB</div>
<!-- <LoginModal session={session} client:visible /> -->
<!-- hx-vals=`js:{"q": document.getElementById("search-input").value}` -->

<div>
	<input
		type="text"
		id="search-input"
		hx-get="/api/search"
		hx-vals='js:{"q": document.getElementById("search-input").value.length > 2 ? document.getElementById("search-input").value : null}'
		hx-trigger="keyup changed delay:500ms"
		hx-target="#search-result"
		hx-swap-oob="true"
		placeholder="Search content..."
		class=" bg-transparent text-white border-2 border-violet-80 rounded w-full p-2 mt-2 mb-2"
	/>

	<div id="search-result"></div>
</div>
<LoginModal client:load />
<header class="main-header">
	<nav class="header-container">
		<Hamburger />
		<Navigation />
	</nav>

	<!-- <form hx-post>
		<label>
			
		</label>
	</form> -->
	<!-- hx-get="/api/search?q=${encodeURIComponent(this.value)}" -->
	<!-- hx-params=`${'q=' + encodeURIComponent(this.value)}` -->
	<!-- hx-params="q:_" -->
</header>

<style>
	.header-container {
		/* min-height: 70px; */
		/* max-height: 100px; */
		/* height: 70px; */
		/* display: grid; */
		/* align-items: center; */
	}

	.kire-web {
		font-family: Norse;
		font-size: 50px;
		letter-spacing: 4ch;
		text-align: center;
		margin-right: -4ch;
	}
</style>
